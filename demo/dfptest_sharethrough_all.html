
<!doctype html>
<head>
    <script src="http://code.jquery.com/jquery-2.0.3.min.js"></script>
    <script src="js/dfploader2.js"></script>
    <script>
    var adunits = {
                "HipHopWiredMobileNativeROS-1" : {
                    "id": "1005159/HipHopWiredMobileNativeROS-1",
                    "size": [[1, 1]]
                },
                "HipHopWiredMobileNativeROS-2" : {
                    "id": "1005159/HipHopWiredMobileNativeROS-2",
                    "size": [[1, 1]]
                },
                "HipHopWiredMobileNativeROS-3" : {
                    "id": "1005159/HipHopWiredMobileNativeROS-3",
                    "size": [[1, 1]]
                },
                "HipHopWiredMobileNativeROS-4" : {
                    "id": "1005159/HipHopWiredMobileNativeROS-4",
                    "size": [[1, 1]]
                },
                "HipHopWiredMobileNativeROS-5" : {
                    "id": "1005159/HipHopWiredMobileNativeROS-5",
                    "size": [[1, 1]]
                },
                "HipHopWiredMobileNativeROS-6" : {
                    "id": "1005159/HipHopWiredMobileNativeROS-6",
                    "size": [[1, 1]]
                }
    };
   window.onmessage= function(e) {
     console.log("toolbar_hiphop.onmessage:"+e.data);
    };
    function refresh(k,v){
       var stamp = new Date().getTime();
       var id = ""+k+stamp;
       $("#container").append(v.id+"<br><div id='"+id+"'></div><br>");
        $("#"+k+stamp).dfpgun({
                        "adunit":v.id,
                        "sizes":v.size
           });
      };
    </script>
</head>

<body>
<div>
    <input type="button" id="trigger" value="TriggerAgain"/>

    <div id="container"></div>
    
    <script type="text/javascript">
    var shtscriptloaded = false;
    $("#container").empty();
    if (!shtscriptloaded) {
        // loading that weird script required by sharethrough.
        var head = document.getElementsByTagName('head')[0];
        var script = document.createElement('script');
        script.type = 'text/javascript';
        script.onload = function() {
            var adar=[];
            $.each(adunits,function(k,v){
                adar.push({"key":k,"value":v});
            });

        var i=0;
        var cid =  setInterval(function(){
                refresh(adar[i].key,adar[i].value);
                i++;
                if(i>=adar.length){
                    clearInterval(cid);
                }
            },1000);
             shtscriptloaded = true;
        };
        script.src = "http://native.sharethrough.com/assets/tag.js?" + (new Date).getTime();
        head.appendChild(script);
    }
    
    </script>
</div>

</body>
</html>